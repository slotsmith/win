<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Slot Smith Pro - Login</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  /* Basic reset and font */
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #1f1f2e;
    color: #fff;
    margin: 0;
    padding: 20px;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* Fade-in animation for login container */
  @keyframes fadeIn {
    from {opacity: 0; transform: translateY(-10px);}
    to {opacity: 1; transform: translateY(0);}
  }

  #loginContainer {
    max-width: 400px;
    width: 100%;
    animation: fadeIn 0.6s ease forwards;
  }

  /* Center the app container and content for main page */
  #app {
    max-width: 900px;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center; /* horizontal center */
    justify-content: flex-start; /* start top */
    margin: auto;
    min-height: 90vh;
  }

  /* Headings centered and color */
  h1, h2 {
    text-align: center;
    color: #00ffc3;
  }

  /* Hide elements */
  .hidden {
    display: none;
  }

  /* Inputs and buttons style */
  input, button {
    display: block;
    width: 100%;
    margin: 10px auto;
    padding: 10px;
    border-radius: 10px;
    border: none;
    font-size: 1rem;
    background: #2c2c3c;
    color: #fff;
    outline: none; /* no focus outline */
    box-shadow: none; /* no focus shadow */
    transition: background-color 0.3s ease;
  }

  input::placeholder {
    color: #66fff0cc;
  }

  button {
    background: #00ffc3;
    color: #000;
    cursor: pointer;
    font-weight: bold;
  }

  button:hover {
    background: #00cc9a;
  }

  /* Remove highlight or outline on focus */
  input:focus, button:focus {
    outline: none;
    box-shadow: none;
  }

  /* Link buttons style */
  .link-btn {
    background: none;
    border: none;
    color: #00ffc3;
    text-decoration: underline;
    cursor: pointer;
    font-size: 1rem;
    padding: 0;
    margin: 0 0 10px 0;
  }

  /* Slots container grid and cards styling */
  #slotsContainer {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
    gap: 30px;
    margin-top: 20px;
    width: 100%;
  }

  .slot-card {
    background: #2c2c3c;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.4);
  }

  .slot-card h3 {
    margin: 0 0 15px;
    color: #00d4ff;
    word-break: break-word;
  }

  .stat {
    margin: 8px 0;
    font-size: 1.1rem;
  }

  .graph-canvas {
    margin-top: 20px;
    width: 100% !important;
    max-height: 90px !important;
    height: auto !important;
  }

  .green {
    color: #00ffb3;
    font-weight: 600;
  }

  .yellow {
    color: #ffd966;
    font-weight: 600;
  }

  .red {
    color: #ff6666;
    font-weight: 600;
  }

  /* Admin panel textarea */
  #adminPanel textarea {
    width: 100%;
    height: 250px;
    background: #222233;
    color: #00ffc3;
    font-family: monospace;
    font-size: 1rem;
    border-radius: 15px;
    padding: 10px;
    box-sizing: border-box;
  }

  /* Buttons for logout and toggle mode */
  #logoutBtn {
    margin-top: 20px;
    background: #ff4c4c;
    color: #fff;
    width: 200px;
  }

  #toggleModeBtn {
    margin-top: 10px;
    background: #0077cc;
    color: #fff;
  }

  /* Message styling */
  #message {
    text-align: center;
    margin: 10px 0;
    color: #ff5555;
    min-height: 1.2em; /* preserve space */
  }
</style>
</head>
<body>

<div id="loginContainer">
  <h1>🎰 Slot Smith Pro - Login</h1>
  <div id="message"></div>

  <form id="loginForm">
    <input type="text" id="loginUsername" placeholder="Username" required autocomplete="off" />
    <input type="password" id="loginPassword" placeholder="Password" required autocomplete="off" />
    <button type="submit">Login</button>
  </form>

  <button class="link-btn" id="showRegisterBtn">Don't have an account? Register</button>
  <button class="link-btn" id="showResetBtn">Forgot Password?</button>

  <form id="registerForm" class="hidden">
    <h2>Register</h2>
    <input type="text" id="regUsername" placeholder="Choose a username" required autocomplete="off" />
    <input type="email" id="regEmail" placeholder="Your email" required autocomplete="off" />
    <input type="password" id="regPassword" placeholder="Password" required autocomplete="off" />
    <input type="password" id="regPasswordConfirm" placeholder="Confirm Password" required autocomplete="off" />
    <button type="submit">Register</button>
    <button class="link-btn" type="button" id="backToLoginFromReg">Back to Login</button>
  </form>

  <form id="resetForm" class="hidden">
    <h2>Reset Password</h2>
    <input type="text" id="resetUsername" placeholder="Username" required autocomplete="off" />
    <input type="email" id="resetEmail" placeholder="Registered Email" required autocomplete="off" />
    <button type="submit">Reset Password</button>
    <button class="link-btn" type="button" id="backToLoginFromReset">Back to Login</button>
  </form>
</div>

<div id="app" class="hidden">
  <h1>🎰 Slot Smith Pro</h1>
  <p id="lastUpdated">Last updated: --</p>
  <input type="text" id="searchBar" placeholder="Search for a slot game..." />
  <div id="slotsContainer"></div>

  <div id="adminPanel" class="hidden">
    <h2>Admin Panel: Edit Slot Games (one per line)</h2>
    <textarea id="adminTextarea"></textarea>
    <button id="saveSlotsBtn">Save Changes</button>
  </div>

  <button id="logoutBtn">Logout</button>
</div>

<script>
  // Utility functions
  function randomFloat(min, max) {
    return (Math.random() * (max - min) + min).toFixed(2);
  }

  function generateFakeHistory() {
    return Array.from({ length: 10 }, () => parseFloat(randomFloat(0, 100)));
  }

  function recommendBet(prediction) {
    if (prediction > 80) return "High Bet";
    if (prediction > 60) return "Medium Bet";
    if (prediction > 40) return "Low Bet";
    return "Skip Bet";
  }

  function recommendBetAmount(rate) {
    if (rate > 80) return "₱1000 Max";
    if (rate > 70) return "₱500–₱999";
    if (rate > 50) return "₱200–₱499";
    if (rate > 30) return "₱50–₱199";
    return "₱0–₱49";
  }

  function recommendSpinType(avg, prediction) {
    if (prediction > 75 || (prediction - avg) > 15) return "Buy Spin (📈 High Spike)";
    if (prediction > 50) return "Normal Spin (Safe)";
    return "Avoid Spin (⚠️ Low Odds)";
  }

  function createChart(ctx, data) {
    return new Chart(ctx, {
      type: 'line',
      data: {
        labels: Array.from({ length: data.length }, (_, i) => `T-${data.length - i}`),
        datasets: [{
          data: data,
          borderColor: 'rgba(0,255,255,0.8)',
          backgroundColor: 'rgba(0,255,255,0.2)',
          fill: true,
          tension: 0.3,
          pointRadius: 0,
          borderWidth: 2,
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: { display: false },
          y: { display: false, min: 0, max: 100 }
        },
        plugins: {
          legend: { display: false },
          tooltip: { enabled: false }
        },
        elements: {
          line: { borderJoinStyle: 'round' }
        }
      }
    });
  }

  // Initial slot games list
  let slotGames = [
    "7 Coins",
    "7 Koi Gate",
    "Aztec Gems",
    "Sweet Bonanza",
    "Crypto Gold",
    "Chilli Heat",
    "Dolphin Reef",
    "Fire Strike",
    "Wolf Gold",
    "Dog House",
  ];

  // Cached data for slots
  let slotsData = [];

  // User mode state
  let isAdmin = false;
  let isUserMode = false;

  // DOM elements
  const loginContainer = document.getElementById('loginContainer');
  const appContainer = document.getElementById('app');
  const messageDiv = document.getElementById('message');

  const loginForm = document.getElementById('loginForm');
  const registerForm = document.getElementById('registerForm');
  const resetForm = document.getElementById('resetForm');

  const showRegisterBtn = document.getElementById('showRegisterBtn');
  const showResetBtn = document.getElementById('showResetBtn');
  const backToLoginFromReg = document.getElementById('backToLoginFromReg');
  const backToLoginFromReset = document.getElementById('backToLoginFromReset');

  const logoutBtn = document.getElementById('logoutBtn');

  const searchBar = document.getElementById('searchBar');
  const slotsContainer = document.getElementById('slotsContainer');
  const lastUpdated = document.getElementById('lastUpdated');

  const adminPanel = document.getElementById('adminPanel');
  const adminTextarea = document.getElementById('adminTextarea');
  const saveSlotsBtn = document.getElementById('saveSlotsBtn');

  // Show/Hide forms
  showRegisterBtn.onclick = () => {
    loginForm.classList.add('hidden');
    registerForm.classList.remove('hidden');
    resetForm.classList.add('hidden');
    messageDiv.textContent = '';
  };

  showResetBtn.onclick = () => {
    loginForm.classList.add('hidden');
    registerForm.classList.add('hidden');
    resetForm.classList.remove('hidden');
    messageDiv.textContent = '';
  };

  backToLoginFromReg.onclick = () => {
    loginForm.classList.remove('hidden');
    registerForm.classList.add('hidden');
    resetForm.classList.add('hidden');
    messageDiv.textContent = '';
  };

  backToLoginFromReset.onclick = () => {
    loginForm.classList.remove('hidden');
    registerForm.classList.add('hidden');
    resetForm.classList.add('hidden');
    messageDiv.textContent = '';
  };

  // Fake authentication for demo
  function fakeAuth(username, password) {
    // For demo: admin user = admin/admin, others fail
    if (username === 'admin' && password === 'admin') return { success: true, role: 'admin' };
    if (username && password) return { success: true, role: 'user' };
    return { success: false, error: 'Invalid credentials' };
  }

  // Login form submit
  loginForm.addEventListener('submit', e => {
    e.preventDefault();
    const username = document.getElementById('loginUsername').value.trim();
    const password = document.getElementById('loginPassword').value.trim();
    const result = fakeAuth(username, password);
    if (result.success) {
      isAdmin = (result.role === 'admin');
      isUserMode = false;
      messageDiv.textContent = '';
      loginContainer.classList.add('hidden');
      appContainer.classList.remove('hidden');
      adminPanel.classList.toggle('hidden', !isAdmin);
      loadSlotGames();
      renderSlots();
      lastUpdated.textContent = `Last updated: ${new Date().toLocaleString()}`;
    } else {
      messageDiv.textContent = result.error;
    }
  });

  // Register form submit (fake)
  registerForm.addEventListener('submit', e => {
    e.preventDefault();
    const username = document.getElementById('regUsername').value.trim();
    const email = document.getElementById('regEmail').value.trim();
    const password = document.getElementById('regPassword').value;
    const passwordConfirm = document.getElementById('regPasswordConfirm').value;
    if (!username || !email || !password) {
      messageDiv.textContent = 'Please fill all fields.';
      return;
    }
    if (password !== passwordConfirm) {
      messageDiv.textContent = 'Passwords do not match.';
      return;
    }
    messageDiv.textContent = `User ${username} registered (demo only). Please login.`;
    registerForm.reset();
    registerForm.classList.add('hidden');
    loginForm.classList.remove('hidden');
  });

  // Reset form submit (fake)
  resetForm.addEventListener('submit', e => {
    e.preventDefault();
    const username = document.getElementById('resetUsername').value.trim();
    const email = document.getElementById('resetEmail').value.trim();
    if (!username || !email) {
      messageDiv.textContent = 'Please fill all fields.';
      return;
    }
    messageDiv.textContent = `Password reset link sent to ${email} (demo only).`;
    resetForm.reset();
    resetForm.classList.add('hidden');
    loginForm.classList.remove('hidden');
  });

  // Logout button
  logoutBtn.addEventListener('click', () => {
    isAdmin = false;
    isUserMode = false;
    messageDiv.textContent = '';
    loginForm.reset();
    registerForm.reset();
    resetForm.reset();
    adminTextarea.value = '';
    loginContainer.classList.remove('hidden');
    appContainer.classList.add('hidden');
  });

  // Load slot games into slotsData with fake stats and history
  function loadSlotGames() {
    slotsData = slotGames.map(name => {
      let prediction = parseFloat(randomFloat(30, 95));
      let rate = parseFloat(randomFloat(10, 100));
      let history = generateFakeHistory();
      let avgHistory = history.reduce((a, b) => a + b, 0) / history.length;
      return {
        name,
        prediction,
        rate,
        history,
        avgHistory,
      };
    });
  }

  // Render slots cards filtered by search
  function renderSlots() {
    const searchTerm = searchBar.value.trim().toLowerCase();
    slotsContainer.innerHTML = '';

    let filtered = slotsData.filter(slot => slot.name.toLowerCase().includes(searchTerm));

    if (filtered.length === 0) {
      slotsContainer.innerHTML = `<p style="text-align:center; color:#888;">No slots found.</p>`;
      return;
    }

    filtered.forEach((slot, index) => {
      const card = document.createElement('div');
      card.classList.add('slot-card');

      // Choose color based on prediction
      let predictionClass = slot.prediction > 80 ? 'green' :
                            slot.prediction > 60 ? 'yellow' : 'red';

      let rateClass = slot.rate > 70 ? 'green' :
                      slot.rate > 50 ? 'yellow' : 'red';

      card.innerHTML = `
        <h3>${slot.name}</h3>
        <p class="stat">Prediction: <span class="${predictionClass}">${slot.prediction.toFixed(2)}%</span></p>
        <p class="stat">Win Rate: <span class="${rateClass}">${slot.rate.toFixed(2)}%</span></p>
        <p class="stat">Recommendation: <strong>${recommendBet(slot.prediction)}</strong></p>
        <p class="stat">Recommended Bet Amount: <strong>${recommendBetAmount(slot.rate)}</strong></p>
        <p class="stat">Spin Type: <strong>${recommendSpinType(slot.avgHistory, slot.prediction)}</strong></p>
        <canvas class="graph-canvas" id="chart-${index}"></canvas>
      `;

      slotsContainer.appendChild(card);

      // Draw chart
      const ctx = document.getElementById(`chart-${index}`).getContext('2d');
      createChart(ctx, slot.history);
    });
  }

  // Search bar input event
  searchBar.addEventListener('input', () => {
    renderSlots();
  });

  // Admin panel save button
  saveSlotsBtn.addEventListener('click', () => {
    const lines = adminTextarea.value.split('\n').map(l => l.trim()).filter(l => l.length > 0);
    if (lines.length === 0) {
      alert('Please enter at least one slot game.');
      return;
    }
    slotGames = lines;
    loadSlotGames();
    renderSlots();
    alert('Slot games updated.');
  });

  // Initialize admin textarea when admin panel shown
  function updateAdminTextarea() {
    adminTextarea.value = slotGames.join('\n');
  }

  // When admin panel visibility toggled, update textarea
  // Called only on login currently
  if (isAdmin) updateAdminTextarea();

</script>
</body>
</html>
